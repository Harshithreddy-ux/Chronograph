<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChronoGraph - Agentic Code Learning Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        * { font-family: 'Inter', sans-serif; }
        body { background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #0f172a 100%); overflow-x: hidden; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); background-size: 200% 200%; animation: gradientShift 8s ease infinite; }
        @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .glow-button { position: relative; overflow: hidden; transition: all 0.3s ease; box-shadow: 0 0 20px rgba(99, 102, 241, 0.5); }
        .glow-button:hover { transform: translateY(-2px); box-shadow: 0 0 30px rgba(99, 102, 241, 0.8), 0 0 60px rgba(99, 102, 241, 0.4); }
        .glow-button::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent); transform: rotate(45deg); animation: shine 3s infinite; }
        @keyframes shine { 0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); } 100% { transform: translateX(100%) translateY(100%) rotate(45deg); } }
        .pulse-glow { animation: pulseGlow 2s ease-in-out infinite; }
        @keyframes pulseGlow { 0%, 100% { box-shadow: 0 0 20px rgba(34, 211, 238, 0.4); } 50% { box-shadow: 0 0 40px rgba(34, 211, 238, 0.8), 0 0 60px rgba(34, 211, 238, 0.4); } }
        .node { cursor: pointer; transition: all 0.3s ease; }
        .node:hover { filter: drop-shadow(0 0 10px rgba(74, 222, 128, 0.8)); }
        .edge { stroke: #4ade80; stroke-width: 2; fill: none; marker-end: url(#arrowhead); animation: flowAnimation 2s linear infinite; }
        @keyframes flowAnimation { 0% { stroke-dashoffset: 20; } 100% { stroke-dashoffset: 0; } }
        .card-hover { transition: all 0.3s ease; border: 1px solid rgba(99, 102, 241, 0.3); }
        .card-hover:hover { transform: translateY(-5px); border-color: rgba(99, 102, 241, 0.6); box-shadow: 0 10px 40px rgba(99, 102, 241, 0.3); }
        .typing-indicator { display: inline-flex; gap: 4px; }
        .typing-indicator span { width: 8px; height: 8px; border-radius: 50%; background: #4ade80; animation: typing 1.4s infinite; }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing { 0%, 60%, 100% { transform: translateY(0); opacity: 0.7; } 30% { transform: translateY(-10px); opacity: 1; } }
        .particle { position: absolute; width: 4px; height: 4px; background: rgba(99, 102, 241, 0.6); border-radius: 50%; pointer-events: none; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0) translateX(0); opacity: 0; } 50% { opacity: 1; } 100% { transform: translateY(-100px) translateX(50px); opacity: 0; } }
        .status-badge { animation: statusPulse 2s ease-in-out infinite; }
        @keyframes statusPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <div id="particles" class="fixed inset-0 pointer-events-none z-0"></div>
    <div class="relative z-10 h-screen flex flex-col">
        <header class="gradient-bg p-6 shadow-2xl">
            <div class="flex items-center justify-between max-w-7xl mx-auto">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-white rounded-lg flex items-center justify-center shadow-lg">
                        <i class="fas fa-clock text-purple-600 text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold text-white">ChronoGraph</h1>
                        <p class="text-purple-100 text-sm">Agentic Code Learning Platform</p>
                    </div>
                </div>
                <div class="flex gap-3 items-center" id="controls">
                    <div class="relative">
                        <i class="fas fa-link absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                        <input type="text" id="repoUrl" value="https://github.com/example/repo" placeholder="GitHub repo URL" class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg px-10 py-3 w-80 text-white placeholder-gray-300 focus:outline-none focus:ring-2 focus:ring-white/50 transition">
                    </div>
                    <select id="faultType" class="bg-white/10 backdrop-blur-sm border border-white/20 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-white/50 transition">
                        <option value="race_condition">⚡ Race Condition</option>
                        <option value="memory_leak">💧 Memory Leak</option>
                        <option value="deadlock">🔒 Deadlock</option>
                    </select>
                    <button onclick="startMission()" class="glow-button bg-white text-purple-600 font-semibold px-6 py-3 rounded-lg flex items-center gap-2">
                        <i class="fas fa-rocket"></i> Start Mission
                    </button>
                </div>
                <div id="sessionInfo" class="hidden flex items-center gap-2 bg-green-500/20 backdrop-blur-sm border border-green-500/30 px-4 py-2 rounded-lg">
                    <div class="w-2 h-2 bg-green-400 rounded-full status-badge"></div>
                    <span class="text-green-100 text-sm font-medium">Active Session</span>
                </div>
            </div>
        </header>
        <div class="flex-1 grid grid-cols-2 gap-6 p-6 max-w-7xl mx-auto w-full">
            <div class="flex flex-col gap-6">
                <div class="card-hover bg-gray-800/50 backdrop-blur-sm rounded-2xl border p-6 h-[500px] shadow-xl">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-gradient-to-br from-cyan-500 to-blue-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-project-diagram text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-bold text-white">Dependency Graph</h3>
                                <p class="text-gray-400 text-xs">Interactive code visualization</p>
                            </div>
                        </div>
                    </div>
                    <svg id="graph" width="100%" height="400" class="rounded-lg">
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#4ade80" />
                            </marker>
                            <filter id="glow">
                                <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
                                <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
                            </filter>
                        </defs>
                    </svg>
                </div>
                <div class="card-hover bg-gray-800/50 backdrop-blur-sm rounded-2xl border p-6 shadow-xl pulse-glow">
                    <div class="flex items-center gap-3 mb-4">
                        <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-history text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-bold text-white">Time Travel Debugger</h3>
                            <p class="text-gray-400 text-xs">Navigate execution timeline</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-4">
                        <button onclick="playTimeline()" class="w-10 h-10 bg-purple-600 hover:bg-purple-500 rounded-lg flex items-center justify-center transition">
                            <i class="fas fa-play text-white"></i>
                        </button>
                        <div class="flex-1 relative">
                            <input type="range" id="timeline" min="0" max="100" value="0" class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer" oninput="updateTime(this.value)">
                            <div class="flex justify-between mt-2 text-xs text-gray-400">
                                <span>T=<span id="timeValue" class="text-purple-400 font-mono">0</span>ms</span>
                                <span class="text-gray-500">100ms</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex flex-col gap-6">
                <div class="card-hover bg-gray-800/50 backdrop-blur-sm rounded-2xl border overflow-hidden shadow-xl h-[280px]">
                    <div class="bg-gradient-to-r from-gray-700/50 to-gray-800/50 px-4 py-3 flex items-center justify-between border-b border-gray-700">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-green-500 to-emerald-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-code text-white text-sm"></i>
                            </div>
                            <span class="text-sm font-semibold text-white">Code Editor</span>
                        </div>
                        <div class="flex gap-1">
                            <div class="w-3 h-3 bg-red-500 rounded-full"></div>
                            <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
                            <div class="w-3 h-3 bg-green-500 rounded-full"></div>
                        </div>
                    </div>
                    <div class="p-4 h-[calc(100%-52px)] overflow-auto">
                        <pre id="codeEditor" class="text-sm font-mono text-gray-300 leading-relaxed"><span class="text-gray-500"># Select a function from the graph to view code</span></pre>
                    </div>
                </div>
                <div class="card-hover bg-gray-800/50 backdrop-blur-sm rounded-2xl border overflow-hidden shadow-xl h-[500px] flex flex-col">
                    <div class="bg-gradient-to-r from-blue-600/50 to-purple-600/50 px-4 py-3 flex items-center justify-between border-b border-gray-700">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 bg-white rounded-lg flex items-center justify-center">
                                <i class="fas fa-robot text-blue-600 text-sm"></i>
                            </div>
                            <div>
                                <span class="text-sm font-semibold text-white">AI Tutor</span>
                                <div class="flex items-center gap-2 text-xs text-blue-100">
                                    <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                    <span>Online</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="chatMessages" class="flex-1 overflow-y-auto p-4 space-y-4">
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-lg flex items-center justify-center flex-shrink-0">
                                <i class="fas fa-robot text-white text-xs"></i>
                            </div>
                            <div class="bg-gray-700/50 rounded-2xl rounded-tl-none px-4 py-3 max-w-[80%]">
                                <p class="text-sm text-gray-200">👋 Welcome! I'm your AI tutor. Start a mission to begin learning about code bugs through interactive debugging.</p>
                            </div>
                        </div>
                    </div>
                    <div class="p-4 border-t border-gray-700 bg-gray-800/30">
                        <div class="flex gap-2">
                            <input type="text" id="chatInput" placeholder="Ask about the bug..." class="flex-1 bg-gray-700/50 border border-gray-600 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-purple-500 transition" onkeypress="if(event.key==='Enter') sendMessage()">
                            <button onclick="sendMessage()" class="glow-button bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 px-6 py-3 rounded-xl text-white font-medium transition flex items-center gap-2">
                                <i class="fas fa-paper-plane"></i> Send
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="bg-gray-800/30 backdrop-blur-sm border-t border-gray-700 px-6 py-4">
            <div class="max-w-7xl mx-auto flex items-center justify-between">
                <div class="flex gap-8">
                    <div class="flex items-center gap-2">
                        <i class="fas fa-code text-cyan-400"></i>
                        <span class="text-sm text-gray-400">Functions: <span id="funcCount" class="text-white font-semibold">5</span></span>
                    </div>
                    <div class="flex items-center gap-2">
                        <i class="fas fa-bug text-red-400"></i>
                        <span class="text-sm text-gray-400">Bugs Found: <span id="bugCount" class="text-white font-semibold">1</span></span>
                    </div>
                    <div class="flex items-center gap-2">
                        <i class="fas fa-clock text-purple-400"></i>
                        <span class="text-sm text-gray-400">Session Time: <span id="sessionTime" class="text-white font-semibold">00:00</span></span>
                    </div>
                </div>
                <div class="text-xs text-gray-500">
                    Powered by <span class="text-purple-400 font-semibold">LangGraph</span> • <span class="text-cyan-400 font-semibold">Neo4j</span> • <span class="text-green-400 font-semibold">E2B</span>
                </div>
            </div>
        </div>
    </div>
    <script>
        let sessionId = null, messageCount = 0, sessionStartTime = null, timelineInterval = null;
        const mockResponses = [
            "Let's use the Scaffolding approach. First, what do you observe about the handle_request() function? 🔍",
            "Good observation! Now, what programming concept might be relevant when multiple threads access shared resources? 🧵",
            "Exactly! What could you try to ensure thread-safe access to the database? 🔒",
            "Notice that handle_request() calls db_save() without any synchronization. What happens when two threads call this simultaneously? ⚡",
            "Think about race conditions. When two threads execute db_save() at the same time, what could go wrong? 💥",
            "Right! You could use a threading.Lock() to protect the critical section. Where would you place it? 🎯"
        ];
        
        function createParticles() {
            const container = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 3 + 's';
                particle.style.animationDuration = (Math.random() * 2 + 2) + 's';
                container.appendChild(particle);
            }
        }
        
        function startMission() {
            sessionId = 'demo-session-' + Date.now();
            sessionStartTime = Date.now();
            document.getElementById('sessionInfo').classList.remove('hidden');
            document.getElementById('controls').classList.add('hidden');
            drawGraph();
            updateSessionTime();
            addMessage('assistant', '🚀 Mission started! I\'ve injected a race condition into the code. Explore the dependency graph and ask me questions to learn about the bug.');
            animateValue('funcCount', 0, 5, 1000);
            animateValue('bugCount', 0, 1, 1500);
        }
        
        function drawGraph() {
            const svg = document.getElementById('graph');
            const nodes = [
                { id: 1, label: 'main.py', x: 250, y: 50, color: '#3b82f6' },
                { id: 2, label: 'handle_request()', x: 150, y: 150, color: '#8b5cf6' },
                { id: 3, label: 'db_save()', x: 350, y: 150, color: '#ef4444' },
                { id: 4, label: 'process_data()', x: 150, y: 250, color: '#10b981' },
                { id: 5, label: 'validate()', x: 350, y: 250, color: '#f59e0b' }
            ];
            const edges = [{ from: 1, to: 2 }, { from: 2, to: 3 }, { from: 2, to: 4 }, { from: 4, to: 5 }];
            
            edges.forEach((edge, idx) => {
                const from = nodes.find(n => n.id === edge.from);
                const to = nodes.find(n => n.id === edge.to);
                const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                line.setAttribute('x1', from.x); line.setAttribute('y1', from.y);
                line.setAttribute('x2', to.x); line.setAttribute('y2', to.y);
                line.setAttribute('class', 'edge');
                line.setAttribute('stroke-dasharray', '5,5');
                line.style.animationDelay = (idx * 0.2) + 's';
                svg.appendChild(line);
            });
            
            nodes.forEach((node, idx) => {
                const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
                g.setAttribute('class', 'node');
                g.onclick = () => showCode(node.label);
                g.style.opacity = '0';
                g.style.animation = `fadeIn 0.5s ease forwards ${idx * 0.1}s`;
                
                const rect = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
                rect.setAttribute('x', node.x - 60); rect.setAttribute('y', node.y - 20);
                rect.setAttribute('width', 120); rect.setAttribute('height', 40);
                rect.setAttribute('fill', node.color); rect.setAttribute('stroke', '#fff');
                rect.setAttribute('stroke-width', '2'); rect.setAttribute('rx', 8);
                rect.setAttribute('filter', 'url(#glow)');
                
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', node.x); text.setAttribute('y', node.y + 5);
                text.setAttribute('text-anchor', 'middle'); text.setAttribute('fill', 'white');
                text.setAttribute('font-size', '12'); text.setAttribute('font-weight', '600');
                text.textContent = node.label;
                
                g.appendChild(rect); g.appendChild(text); svg.appendChild(g);
            });
        }
        
        function showCode(label) {
            const codeExamples = {
                'main.py': '<span class="text-gray-500"># main.py</span>\n<span class="text-purple-400">from</span> flask <span class="text-purple-400">import</span> Flask\napp = Flask(__name__)\n\n<span class="text-blue-400">@app.route</span>(<span class="text-green-400">"/"</span>)\n<span class="text-purple-400">def</span> <span class="text-yellow-400">index</span>():\n    <span class="text-purple-400">return</span> handle_request()',
                'handle_request()': '<span class="text-purple-400">def</span> <span class="text-yellow-400">handle_request</span>():\n    data = get_data()\n    result = process_data(data)\n    <span class="text-red-400"># FAULT: No lock!</span>\n    db_save(result)\n    <span class="text-purple-400">return</span> result',
                'db_save()': '<span class="text-purple-400">def</span> <span class="text-yellow-400">db_save</span>(data):\n    <span class="text-red-400"># Critical section - not thread-safe!</span>\n    conn = get_db_connection()\n    conn.execute(<span class="text-green-400">"INSERT INTO data VALUES (?)"</span>, data)\n    conn.commit()',
                'process_data()': '<span class="text-purple-400">def</span> <span class="text-yellow-400">process_data</span>(data):\n    validated = validate(data)\n    <span class="text-purple-400">return</span> transform(validated)',
                'validate()': '<span class="text-purple-400">def</span> <span class="text-yellow-400">validate</span>(data):\n    <span class="text-purple-400">if not</span> data:\n        <span class="text-purple-400">raise</span> ValueError(<span class="text-green-400">"Empty data"</span>)\n    <span class="text-purple-400">return</span> data'
            };
            document.getElementById('codeEditor').innerHTML = codeExamples[label] || '<span class="text-gray-500"># Code not available</span>';
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message || !sessionId) return;
            addMessage('user', message);
            input.value = '';
            showTypingIndicator();
            setTimeout(() => {
                hideTypingIndicator();
                const response = mockResponses[messageCount % mockResponses.length];
                addMessage('assistant', response);
                messageCount++;
            }, 1000 + Math.random() * 1000);
        }
        
        function addMessage(role, content) {
            const container = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.className = 'flex items-start gap-3 ' + (role === 'user' ? 'flex-row-reverse' : '');
            div.innerHTML = `
                <div class="w-8 h-8 ${role === 'user' ? 'bg-gradient-to-br from-cyan-500 to-blue-500' : 'bg-gradient-to-br from-blue-500 to-purple-500'} rounded-lg flex items-center justify-center flex-shrink-0">
                    <i class="fas fa-${role === 'user' ? 'user' : 'robot'} text-white text-xs"></i>
                </div>
                <div class="bg-gray-700/50 rounded-2xl ${role === 'user' ? 'rounded-tr-none' : 'rounded-tl-none'} px-4 py-3 max-w-[80%]">
                    <p class="text-sm text-gray-200">${content}</p>
                </div>
            `;
            div.style.opacity = '0';
            div.style.animation = 'fadeIn 0.3s ease forwards';
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }
        
        function showTypingIndicator() {
            const container = document.getElementById('chatMessages');
            const div = document.createElement('div');
            div.id = 'typingIndicator';
            div.className = 'flex items-start gap-3';
            div.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-purple-500 rounded-lg flex items-center justify-center flex-shrink-0">
                    <i class="fas fa-robot text-white text-xs"></i>
                </div>
                <div class="bg-gray-700/50 rounded-2xl rounded-tl-none px-4 py-3">
                    <div class="typing-indicator"><span></span><span></span><span></span></div>
                </div>
            `;
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
        }
        
        function hideTypingIndicator() {
            const indicator = document.getElementById('typingIndicator');
            if (indicator) indicator.remove();
        }
        
        function updateTime(value) {
            document.getElementById('timeValue').textContent = value;
            const slider = document.getElementById('timeline');
            const percent = (value / slider.max) * 100;
            slider.style.background = `linear-gradient(to right, #8b5cf6 0%, #8b5cf6 ${percent}%, #374151 ${percent}%, #374151 100%)`;
        }
        
        function playTimeline() {
            if (timelineInterval) {
                clearInterval(timelineInterval);
                timelineInterval = null;
                return;
            }
            timelineInterval = setInterval(() => {
                const slider = document.getElementById('timeline');
                let val = parseInt(slider.value);
                if (val >= 100) {
                    clearInterval(timelineInterval);
                    timelineInterval = null;
                    return;
                }
                slider.value = val + 1;
                updateTime(slider.value);
            }, 50);
        }
        
        function resetTimeline() {
            if (timelineInterval) {
                clearInterval(timelineInterval);
                timelineInterval = null;
            }
            document.getElementById('timeline').value = 0;
            updateTime(0);
        }
        
        function updateSessionTime() {
            if (!sessionStartTime) return;
            setInterval(() => {
                const elapsed = Math.floor((Date.now() - sessionStartTime) / 1000);
                const mins = Math.floor(elapsed / 60).toString().padStart(2, '0');
                const secs = (elapsed % 60).toString().padStart(2, '0');
                document.getElementById('sessionTime').textContent = `${mins}:${secs}`;
            }, 1000);
        }
        
        function animateValue(id, start, end, duration) {
            const element = document.getElementById(id);
            const range = end - start;
            const increment = range / (duration / 16);
            let current = start;
            const timer = setInterval(() => {
                current += increment;
                if (current >= end) {
                    element.textContent = end;
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current);
                }
            }, 16);
        }
        
        const style = document.createElement('style');
        style.textContent = '@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }';
        document.head.appendChild(style);
        
        createParticles();
    </script>
</body>
</html>
